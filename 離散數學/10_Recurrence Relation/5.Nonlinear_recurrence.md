# Nonlinear Recurrence

## Solution

1. Substitution Method
2. Generating Function Method

### Example 1

$4\sqrt{n} a_n^3 = \sqrt{n+2} a_{n+2}^3$, $a_1 = 1, a_2 = \sqrt{2}$

Let $b_n = \sqrt{n} a_n^3$
$\Rightarrow 4b_n = b_{n+2}$, $b_1 = 1, b_2 = 4$

$b_n = A_1(2)^n + A_2(-2)^n$

$\begin{cases}
2A_1 - 2A_2 = 1 \\
4A_1 + 4A_2 = 4
\end{cases}$

$\Rightarrow A_1 = \dfrac{3}{4}, A_2 = \dfrac{1}{4}$

$b_n = \dfrac{3}{4}(2)^n + \dfrac{1}{4}(-2)^n$

$\therefore a_n = [ \dfrac{3}{4\sqrt{n}}(2)^n + \dfrac{1}{4\sqrt{n}}(-2)^n]$

### Example 2

$a_n + na_{n-1} = n!, a_0 = 1$

$\Rightarrow \dfrac{a_n}{n!} + \dfrac{a_{n-1}}{(n-1)!} = 1$

Let $b_n = \dfrac{a_n}{n!}, b_0 = 1$

$\Rightarrow b_n + b_{n-1} = 1$
$b_n = \frac{1}{2}[(-1)^n + 1]$

$\therefore a_n = \dfrac{n!}{2}[(-1)^n + 1]$

---

## fact

$a = (a_0, a_1, a_2, a_3, a_4, ...)$

Let $b = a * a$

i.e. $\displaystyle b_n = \sum_{i=0}^{n}(a_i, a_{n-i})$

$\begin{aligned} \text{Let } &f(x) = a_0 + a_1x + a_2x^2 + ... \\
&g(x) = b_0 + b_1x + b_2x^2 + ... \end{aligned}$

$\begin{aligned}\text{i.e. } g(x) &= \sum_{n=0}^{\infty} b_nx^n \\
&= \sum_{n=0}^{\infty}[\sum_{i=0}^{n} a_ia_{n-i}]x^n \\
&\Rightarrow g(x) = [f(x)]^2
\end{aligned}$

### Example

Find the number of ways to parenthesize the expression $w_1 + w_2 + .. + w_{n-1} + w_n$ so that only two terms will be added at one time.

$n=2 : \space (w_1 + w_2)$
$\begin{aligned} n=3 : \space &((w_1 + w_2) + w_3) \\
&(w_1 + (w_2 + w_3)) \end{aligned}$
$\begin{aligned} n=4 : \space &((w_1 + w_2) + (w_3 + w_4)) \\
&((w_1 + (w_2 + w_3)) + w_4) \\
&(w_1 + ((w_2 + w_3) + w_4)) \\
&(w_1 + (w_2 + (w_3 + w_4))) \\
&(((w_1 + w_2) + w_3) + w_4)\end{aligned}$

$\Rightarrow a_2 = 1, a_3 = 2, a_4 = 5$

Let $a_n$ denotes the number of wats with n terms consider the two sub-expressions $a_r = w_1 + w_2 + ... + w_r$, $a_{n-r} = w_{r+1} + ... w_n$, $1 \leq r \leq n-1$.

there are $a_r \space a_{n-r}$ ways to parenthesize the overall expressions.

$a_n = a_{n-1}a_1 + a_{n-2}a_2 + ... + a_2a_{n-2} + a_1a_{n-1}$, $n \geq 2$

$\because a_3 = a_2a_1 + a_1a_2$
$\because a_3 = 2, \space a_2 = 1, \space \therefore a_1 = 1$

we choose $a_0 = 0$
$a_n = a_na_0 + a_{n-1}a_1 + .. + a_1a_{n-1} + a_0a_n$

$\displaystyle \sum_{n=2}^{\infty} a_nx^n = \sum_{n=2}^{\infty}(a_na_0 + a_{n-1} + a_1 + ... + a_1a_{n-1} + a_0a^n)x^n$

Let $f(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + ...$
$\begin{aligned} &\Rightarrow \sum_{n=0}^{\infty} a_nx^n - (a_1a_0 + a_0 a_1)x - a_0 \\
&= \sum_{n=0}^{\infty}(a_na_0 + a_{n-1}a_1 + ... + a_1a_{n-1} + a_0a_n)x^n - a(a_1a_0 + a_0a_1)x - a_0 \\
&\Rightarrow f(x) - a_1x - a_0 \\
&= [f(x)]^2 - a_0^2 - (a_1a_0 + a_0a_1)x \\
&\Rightarrow [f(x)]^2 - f(x) + x = 0
\end{aligned}$

$\begin{aligned}\therefore f(x)&=\dfrac{1 \pm \sqrt{1-4x}}{2} \\
&=a_0 + a_1x + ... + a_nx^n + ...
\end{aligned}$

The coefficient of $x^n$ in $\sqrt{1-4x} = (1-4x)^{1/2}$

$\begin{aligned} \Rightarrow \dbinom{1/2}{n}(-4)^n &= \dfrac{1/2(1/2 - 1) ... (1/2 - n + 1)}{n!}(-4)^n \\
&=(-1)^{n-1}\dfrac{1/2 * 1/2 * ... *(\frac{2n-3}{2})}{n!}(-4)^n \\
&=(-1)\dfrac{1*3*...*(2n-3)}{n!}\times2^{n-1} \\
&=\dfrac{-2}{n} \times \dfrac{1*3*...*(2n-3)}{(n-1)!} \times 2^{n-1} \\
&= \dfrac{-2}{n} \times \dfrac{1*3*...*(2n-3) (n-1)!}{(n-1)! (n-1)!} \times 2^{n-1} \\
&= \dfrac{-2}{n} \times \dfrac{1*3*...*(2n-3) * 2 * 4 * ... * (2n-2)}{(n-1)! (n-1)!} \\
&= \dfrac{-2}{n} \times \dfrac{(2n-2)!}{(n-1)!(n-1)!} \\
&= \dfrac{-2}{n} \dbinom{2n-2}{n-1}
\end{aligned}$

$f(x) = \dfrac{1}{2} - \dfrac{1}{2}\sqrt{1-4x}$

$\therefore a_n = \dfrac{1}{n}\dbinom{2n-2}{n-1}$
