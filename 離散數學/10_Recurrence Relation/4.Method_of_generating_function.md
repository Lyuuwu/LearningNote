# Method of generating function

## The reason for using generating function

Recurrence relation is a sequence for $a_0, a_1, a_2, ...$.
And generating function can represent a sequence.

---

## fact

$f(x) = a_0 + a_1x + a_2x^2 + ... + a_nx^n + ...$

1. $f(x) = \frac{1}{1-x} = 1 + x + x^2 + x^3 + ...$
$\Rightarrow a_n = 1$ ;
$f(x) = \frac{c}{1-x} \Rightarrow a_n=c$
2. $f(x) = \frac{1}{(1-x)^2} = 1 + 2x + 3x^2 + ... + (n+1)x^n + ...$
$\Rightarrow a_n = n+1$
3. $f(x) = \frac{1}{1-ax} = 1 + ax + a^2x^2 + ... + a^nx^n + ...$
$\Rightarrow a_n = a^n$
4. $\frac{1}{(1-ax)^2} = 1 + 2ax + 3a^nx^n + ... + (n+1)a^nx^n + ...$
$\Rightarrow a_n = (n+1)a^n$

### Example1

$a_{n+1} = a_n + 2$, $a_0 = 1$

$f(x) = a_0 + a_1x + a_2x^2 + ... + a_nx^n + a_{n+1}x^{n+1} + ...$

$-xf(x) = -a_0x - a_1x^2 - ... - a_{n-1}x^n - a_nx^{n+1} - ...$

$-2(\frac{1}{1-x}) = -2 -2x -2x^2 - ... -2x^n - 2x^{n+1} - ...$

$\Rightarrow (1-x)f(x) - \frac{2}{1-x} = (a_0 - 2) + (a_1 - a_0 -2)x + (a_2 - a_1 - 2)x^2 + ... + (a_{n+1} - a_n - 2)x^{n+1} + ...$

$\begin{aligned}
\Rightarrow&(1-x)f(x) - \frac{2}{1-x} = -1 \\
&(1-x)f(x) = \frac{2}{1-x} - 1 \\
&(1-x)f(x) = \frac{1+x}{1-x} \\
&f(x) = \frac{1+x}{(1-x)^n} = \frac{2}{(1-x)^2} - \frac{1}{1-x}
\end{aligned}$

$\begin{aligned}
\because &\frac{2}{(1-x)^2} = 2(n+1) \\
&\frac{-1}{1-x} = -1
\end{aligned}$
$\therefore a_n = 2(n+1) - 1 = 2n + 1$

### Example 2

How many n digits binary sequence that have no adjacent 0's are there?

If the last digit is $0$ then the $(n-1)$th digit should be $1$ $\rightarrow a_{n-2}$
If the last digit is $1$ then the $(n-1)$th digit may be $0$ or $1$ $\rightarrow a_{n-1}$

$\therefore a_n = a_{n-1} + a_{n-2} \space a_0 = 1, a_1 = 2, a_2 = 3$

$f(x) - x(fx) - (x^2)f(x) = (a_0) + (a_1 - a_0)x + (a_2 - a_1 - a_0)x^2 + 0 + ...$

$(1 - x - x^2)f(x) = 1 + x$

$\Rightarrow f(x) = \dfrac{1+x}{1-x-x^2} = \dfrac{A_1}{1 - ax} + \dfrac{A_2}{1 - bx}$

$\Rightarrow a = \dfrac{1 + \sqrt{5}}{2}, b = \dfrac{1 - \sqrt{5}}{2}$

$\begin{cases}
A_1 + A_2 = 1 \\
A_1b + A_2a = -1
\end{cases}$

$\Rightarrow A_1 = \dfrac{5 + 3\sqrt{5}}{10}, A_2 = \dfrac{5 - 3\sqrt{5}}{10}$

$\therefore a_n = \dfrac{5 + 3\sqrt{5}}{10}(\dfrac{1 + \sqrt{5}}{2})^n + \dfrac{5-3\sqrt{5}}{10}(\dfrac{1 - \sqrt{5}}{2})^n$

### Example 3

Among n digits with base 4, how many of them have an even number of $0$'s?

$n = 1: 1, 2, 3$

$\begin{aligned} n=2: \space & 00, 1, 12, 13 \\ &21, 22, 23 \\ &31, 32, 33 \end{aligned}$

$\therefore a_1=3, a_2= 10$

If the last digit is not 0 then there are $3a_{n-1}$ such sequence.
If the last digit is 0 we must determine how many $(n-1)$ digits have odd number of 0's
$\rightarrow 4^{n-1} - a_{n-1}$

$\begin{aligned}
\therefore \space &a_n = 3_a{n-1} + 4^{n-1} - a_{n-1} \\
&a_n = 2a_{n-1} + 4^{n-1} \\
&a_n - 2a_{n-1} - 4^{n-1} = 0 \\
\end{aligned}$
$\because a_1 = 3 \space \therefore a_0 = 1$

$f(x) - 2x(fx) - \frac{x}{1-4x} = (a_0) + (a_1 - 2a_0 - 1)x + 0 + ...$

$(1-2x)f(x) - \frac{x}{1-4x} = 1$

$\begin{aligned}
f(x) &= \frac{1}{1-2x}(\frac{x}{1-4x} + 1) \\
&= \frac{1}{1-2x} \times \frac{1-3x}{1-4x} \\
&= \frac{1/2}{1-2x} + \frac{1/2}{1-4x}
\end{aligned}$

$\therefore a_n = 1/2(2)^n + 1/2(4)^n$
